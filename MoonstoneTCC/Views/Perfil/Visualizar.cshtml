@model MoonstoneTCC.ViewModels.UserProfileViewModel
@{
    ViewData["Title"] = "Meu Perfil";
}

<div class="text-center my-4">
    <img src="/images/avatar-padrao.png" class="rounded-circle shadow" style="width: 120px; height: 120px; object-fit: cover;" alt="Avatar">

    <h2 class="mt-3 fw-bold text-white">@Model.Nome @Model.Sobrenome</h2>
    <span class="text-muted d-block mb-2">@Model.UserName • @Model.Email</span>

    <div class="d-flex justify-content-center gap-4 mt-3 text-light">
        <a asp-controller="Seguidor" asp-action="MinhasConexoes" class="d-flex align-items-center gap-2 text-decoration-none text-white-50 hover-zoom">
            <i class="fa-solid fa-user-friends text-purple"></i>
            <div class="d-flex flex-column align-items-center">
                <strong class="fs-5">@ViewBag.TotalSeguindo</strong>
                <span class="small text-muted">Seguindo</span>
            </div>
        </a>

        <a asp-controller="Seguidor" asp-action="MinhasConexoes" class="d-flex align-items-center gap-2 text-decoration-none text-white-50 hover-zoom">
            <i class="fa-solid fa-users text-purple"></i>
            <div class="d-flex flex-column align-items-center">
                <strong class="fs-5">@ViewBag.TotalSeguidores</strong>
                <span class="small text-muted">Seguidores</span>
            </div>
        </a>
    </div>

    <br>

    @if (ViewBag.InteressesUsuario is List<string> interessesHeader && interessesHeader.Any())
    {
        <div class="d-flex justify-content-center flex-wrap gap-2 small text-muted">
            @foreach (var interesse in interessesHeader)
            {
                <span class="badge bg-dark bg-opacity-50 text-white fw-normal px-3 py-1 rounded-pill">
                    @interesse
                </span>
            }
        </div>
    }
</div>


<div class="container d-flex flex-column align-items-center gap-4">

    <div class="card w-100 shadow-lg p-4 bg-roxo-claro mb-5">
        <div class="d-flex align-items-start gap-3">
            <div class="bg-purple rounded-circle d-flex justify-content-center align-items-center" style="width: 60px; height: 60px;">
                <i class="fa-solid fa-id-card text-white fs-4"></i>
            </div>

            <div class="flex-grow-1 text-light">
                <h5 class="text-purple mb-3 mt-1">
                    <i class="fa-solid fa-user me-2 text-purple"></i> Informações Pessoais
                </h5>

                <div class="mb-2">
                    <i class="fa-solid fa-phone me-2 text-purple"></i>
                    <strong class="text-purple">Telefone:</strong>
                    <span class="badge bg-dark text-white rounded-pill px-3 py-2">
                        @Model.Telefone
                    </span>
                </div>
            </div>
        </div>

        <hr class="border-light my-4" />

        <div class="d-flex justify-content-end align-items-center flex-wrap gap-3 text-light">
            <small class="text-muted">
                <i class="fa-solid fa-clock-rotate-left me-1"></i> Atualizado em @DateTime.Now.ToString("dd/MM/yyyy HH:mm")
            </small>
            <a asp-controller="Account" asp-action="Editar" class="btn btn-outline-purple btn-sm">
                <i class="fa-solid fa-user-gear me-1"></i> Editar Perfil
            </a>
        </div>
    </div>



    <div class="card w-100 shadow-lg p-4 bg-roxo-claro mb-5">
        <div class="d-flex align-items-start gap-3">
            <div class="bg-purple rounded-circle d-flex justify-content-center align-items-center" style="width: 60px; height: 60px;">
                <i class="fa-solid fa-house-user text-white fs-4"></i>
            </div>

            <div class="flex-grow-1 text-light">
                <h5 class="text-purple mb-3 mt-1">
                    <i class="fa-solid fa-map-marker-alt me-2 text-purple"></i> Endereço Principal
                </h5>

                <div class="mb-2">
                    <i class="fa-solid fa-road me-2 text-purple"></i>
                    <strong class="text-purple">Endereço:</strong>
                    <span class="badge bg-dark text-white rounded-pill px-3 py-2">
                        @Model.Endereco1 @Model.Endereco2
                    </span>
                </div>

                <div class="mb-2">
                    <i class="fa-solid fa-city me-2 text-purple"></i>
                    <strong class="text-purple">Cidade / Estado:</strong>
                    <span class="badge badge-purple rounded-pill px-3 py-2">
                        @Model.Cidade - @Model.Estado
                    </span>
                </div>

                <div class="mb-2">
                    <i class="fa-solid fa-mail-bulk me-2 text-purple"></i>
                    <strong class="text-purple">CEP:</strong>
                    <span class="badge bg-purple text-white rounded-pill px-3 py-2">
                        @Model.Cep
                    </span>
                </div>
            </div>
        </div>

        <hr class="border-light my-4" />

        <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 text-light">
            <small class="text-muted">
                <i class="fa-solid fa-clock-rotate-left me-1"></i> Atualizado em @DateTime.Now.ToString("dd/MM/yyyy HH:mm")
            </small>

            <a asp-controller="Endereco" asp-action="Index" class="btn btn-outline-purple btn-sm">
                <i class="fa-solid fa-map-location-dot me-1"></i> Gerenciar Endereços
            </a>
        </div>
    </div>



    @if (Model.UltimoPedido != null && Model.UltimoPedido.PedidoItens.Any())
    {
        var item = Model.UltimoPedido.PedidoItens.FirstOrDefault();

        <div class="card w-100 shadow-lg p-4 bg-roxo-claro mb-5">
            <div class="d-flex align-items-center gap-3">
                <img src="@item.Jogo.ImagemUrl" class="rounded shadow" style="width: 60px; height: 60px; object-fit: cover;" />

                <div class="flex-grow-1">
                    <div class="mb-2 text-light">
                        <i class="fa-regular fa-calendar-check me-1 text-purple"></i>
                        <strong class="text-purple">Último Pedido:</strong>
                        <span class="badge badge-purple rounded-pill px-3 py-2">@Model.UltimoPedido.PedidoEnviado.ToString("dd/MM/yyyy")</span>
                    </div>

                    <div class="mb-2 text-light">
                        <i class="fa-solid fa-money-bill-wave me-1 text-purple"></i>
                        <strong class="text-purple">Valor Total:</strong>
                        <span class="badge bg-purple text-white rounded-pill px-3 py-2">
                            @Model.UltimoPedido.PedidoTotal.ToString("C2")
                        </span>
                    </div>

                    <div class="mb-2 text-light">
                        <i class="fa-solid fa-gamepad me-1 text-purple"></i>
                        <strong class="text-purple">Jogo em destaque:</strong>
                        <span class="badge bg-dark text-white rounded-pill px-3 py-2">
                            @item.Jogo.Nome — @item.Quantidade x @item.Preco.ToString("C2")
                        </span>
                    </div>
                </div>
            </div>

            <hr class="border-light my-4" />

            <div class="d-flex justify-content-between align-items-center flex-wrap gap-3 text-light">
                <div>
                    <i class="fa-solid fa-layer-group me-1 text-purple"></i>
                    <strong class="text-purple">Total de Pedidos:</strong>
                    <span class="badge bg-purple text-white rounded-pill px-3 py-2">@Model.TotalPedidos pedido(s)</span>
                </div>

                <div class="d-flex gap-2 align-items-center">
                    <small class="text-muted me-3">
                        <i class="fa-solid fa-clock-rotate-left me-1"></i> Atualizado em @DateTime.Now.ToString("dd/MM/yyyy HH:mm")
                    </small>

                    <a asp-controller="MeusPedidos" asp-action="Index" class="btn btn-outline-purple btn-sm">
                        <i class="fa-solid fa-box"></i> Mais Detalhes
                    </a>
                </div>
            </div>
        </div>
    }
    else
    {
        <div class="card w-75 shadow p-4 bg-roxo-claro mb-5">
            <div class="alert alert-warning text-center m-0">
                <i class="fa-solid fa-box"></i> Nenhum pedido realizado ainda.
            </div>

            <hr class="border-light my-4" />

            <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
                <span class="text-white fs-6">
                    <strong>Total de Pedidos:</strong> 0
                </span>

                <div class="d-flex gap-2 align-items-center">
                    <small class="text-light me-2">
                        <i class="fa-solid fa-clock-rotate-left me-1"></i> Atualizado em @DateTime.Now.ToString("dd/MM/yyyy HH:mm")
                    </small>

                    <a asp-controller="MeusPedidos" asp-action="Index" class="btn btn-purple btn-sm">
                        <i class="fa-solid fa-box"></i> Acessar Pedidos
                    </a>
                </div>
            </div>
        </div>
    }

    <div class="card w-75 shadow p-4 bg-roxo-claro mb-5">
        <div class="d-flex justify-content-between align-items-center mb-3">
            <h5 class="text-white mb-0"><i class="fa-solid fa-gamepad me-2 text-purple"></i> Meus Interesses</h5>
            <a asp-controller="Interesses" asp-action="Selecionar" class="btn btn-purple btn-sm">
                <i class="fa-solid fa-pen me-1"></i> Alterar
            </a>
        </div>

        @if (ViewBag.InteressesUsuario is List<string> interesses && interesses.Any())
        {
            <div class="d-flex flex-wrap gap-2">
                @foreach (var interesse in interesses)
                {
                    <span class="badge badge-purple text-white fs-6 px-3 py-2 rounded-pill shadow-sm">
                        <i class="fa-solid fa-star me-1"></i> @interesse
                    </span>
                }
            </div>
        }
        else
        {
            <p class="text-light fst-italic">Você ainda não selecionou seus interesses.</p>
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5 class="text-white mb-0"><i class="fa-solid fa-gamepad me-2 text-purple"></i> Meus Interesses</h5>
                <a asp-controller="Interesses" asp-action="Selecionar" class="btn btn-purple btn-sm">
                    <i class="fa-solid fa-pen me-1"></i>Crie agora
                </a>
            </div>
        }
    </div>
    <div class="card w-75 shadow p-4 bg-roxo-claro mb-5 border border-danger">
        <div class="d-flex align-items-start gap-3">
            <div class="bg-danger rounded-circle d-flex justify-content-center align-items-center" style="width: 60px; height: 60px;">
                <i class="fa-solid fa-user-slash text-white fs-4"></i>
            </div>

            <div class="flex-grow-1 text-light">
                <h5 class="text-danger mb-3 mt-1">
                    <i class="fa-solid fa-user-slash me-2 text-danger"></i> Excluir Conta
                </h5>

                <p class="text-light">
                    Esta ação removerá permanentemente sua conta e todos os dados relacionados. Você não poderá desfazer essa operação.
                </p>

                <div class="d-flex justify-content-end">
                    <a asp-controller="Account" asp-action="ExcluirConta" class="btn btn-outline-danger btn-sm">
                        <i class="fa-solid fa-trash-can me-1"></i> Excluir Minha Conta
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .bg-purple {
        background-color: #6a0dad !important;
    }


    .badge-purple {
        background-color: #7c4dff !important;
        color: white !important;
    }
    .btn-outline-purple {
        border: 1px solid #6a0dad;
        color: #6a0dad;
        transition: 0.3s ease;
    }

        .btn-outline-purple:hover {
            background-color: #6a0dad;
            color: white;
        }

    .card {
        border: none;
        border-radius: 1rem;
    }

    .bg-roxo-claro {
        background: linear-gradient(145deg, #3e0070, #4e008a);
        border: 1px solid #6a0dad44;
        box-shadow: 0 0 10px rgba(122, 0, 200, 0.2);
    }

    .btn-purple {
        background-color: #7c4dff;
        color: white;
        border: none;
        transition: 0.3s ease;
    }

        .btn-purple:hover {
            background-color: #6a0dad;
            color: white;
        }

    .hover-zoom:hover {
        transform: scale(1.05);
        transition: 0.3s ease;
    }



</style>
