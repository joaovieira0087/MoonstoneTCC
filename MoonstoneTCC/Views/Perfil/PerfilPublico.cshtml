@model MoonstoneTCC.ViewModels.PerfilPublicoViewModel

<div class="container mt-5 text-white">

    @{
        var usuarioLogadoId = User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier)?.Value;
        var idDoPerfil = Model.UsuarioId;
        var estaSeguindo = Model.EstaSeguindo;
    }

    <div class="text-center mb-5">
        <img src="/images/avatar-padrao.png" class="rounded-circle shadow" style="width: 120px; height: 120px; object-fit: cover;" alt="Avatar">

        <h2 class="mt-3 fw-bold text-white">@Model.NomeUsuario</h2>

        @if (usuarioLogadoId != idDoPerfil)
        {
            <form asp-controller="Seguidor" asp-action="ToggleSeguir" method="post" style="display:inline">
                <input type="hidden" name="seguidoId" value="@Model.UsuarioId" />
                <button type="submit" class="btn @(estaSeguindo ? "btn-purple" : "btn-outline-purple") btn-sm mt-2 hover-zoom">
                    <i class="fa @(estaSeguindo ? "fa-check" : "fa-plus") me-1"></i>
                    @(estaSeguindo ? "Seguindo" : "Seguir")
                </button>
            </form>
        }

        <div class="d-flex justify-content-center gap-4 mt-3 text-white-50">
            <a href="/Seguidor/Conexoes/@Model.UsuarioId#seguindo" class="text-decoration-none hover-zoom">
                <i class="fa-solid fa-user-friends text-purple"></i>
                <div class="d-flex flex-column align-items-center">
                    <strong class="fs-5">@Model.TotalSeguindo</strong>
                    <span class="small text-muted">Seguindo</span>
                </div>
            </a>
            <a href="/Seguidor/Conexoes/@Model.UsuarioId#seguidores" class="text-decoration-none hover-zoom">
                <i class="fa-solid fa-users text-purple"></i>
                <div class="d-flex flex-column align-items-center">
                    <strong class="fs-5">@Model.TotalSeguidores</strong>
                    <span class="small text-muted">Seguidores</span>
                </div>
            </a>
        </div>

        <br />
        <!-- Interesses -->
        @if (Model.Interesses.Any())
        {
            <div class="text-center mb-5">
                <div class="d-flex justify-content-center flex-wrap gap-2">
                    @foreach (var interesse in Model.Interesses)
                    {
                        <span class="badge rounded-pill px-3 py-2 bg-dark text-white small shadow-sm">
                            <i class="fa-solid fa-gamepad me-1 text-purple"></i>@interesse
                        </span>
                    }
                </div>
            </div>
        }
        else
        {
            <div class="text-center mb-5">
                <p class="text-muted">Este usuário ainda não selecionou interesses.</p>
            </div>
        }

    </div>

    <!-- Interesses -->
@*     <div class="card bg-roxo-claro shadow-lg p-4 mb-4">
        <h4 class="text-white mb-3"><i class="fa-solid fa-star text-purple me-2"></i>Interesses</h4>
        @if (Model.Interesses.Any())
        {
            <div class="d-flex flex-wrap gap-2">
                @foreach (var interesse in Model.Interesses)
                {
                    <span class="badge badge-purple text-white fs-6 px-3 py-2 rounded-pill shadow-sm">
                        <i class="fa-solid fa-gamepad me-1"></i> @interesse
                    </span>
                }
            </div>
        }
        else
        {
            <p class="text-muted">Este usuário ainda não selecionou interesses.</p>
        }
    </div> *@

    <div class="card bg-roxo-claro shadow-lg p-4 mb-4">
        <h4 class="text-white mb-3"><i class="fa-solid fa-heart text-danger me-2"></i>Favoritos Públicos</h4>

        @if (Model.FavoritosPublicos != null && Model.FavoritosPublicos.Any())
        {
            <div class="d-flex flex-wrap gap-3">
                @foreach (var jogo in Model.FavoritosPublicos)
                {
                    <div class="jogo-card-spotify text-center position-relative">
                        <a href="@Url.Action("Details", "Jogo", new { jogoId = jogo.JogoId })" class="text-decoration-none text-light">
                            <img src="@jogo.ImagemThumbnailUrl" alt="@jogo.Nome" class="jogo-thumb" />
                            <div class="mt-2 jogo-nome">@jogo.Nome</div>
                        </a>
                        <form method="post" asp-controller="Favorito" asp-action="Adicionar" asp-route-jogoId="@jogo.JogoId">
                            <button type="submit" class="btn btn-outline-light btn-sm mt-2 w-100">
                                <i class="fa-solid fa-plus"></i> Adicionar aos Favoritos
                            </button>
                        </form>
                    </div>
                }
            </div>

            <!-- Importar todos -->
            <form method="post" asp-controller="Favorito" asp-action="ImportarTodos" asp-route-usuarioId="@Model.UsuarioId">
                <button class="btn btn-purple mt-4 d-block mx-auto">
                    <i class="fa-solid fa-file-import me-2"></i> Importar todos os favoritos
                </button>
            </form>
        }
        else
        {
            <p class="text-muted">Este usuário ainda não possui favoritos públicos.</p>
        }
    </div>

    <!-- Listas Públicas -->
    <div class="card bg-roxo-claro shadow-lg p-4 mb-5">
        <h4 class="text-white mb-3"><i class="fa-solid fa-list text-purple me-2"></i>Listas Públicas</h4>
        @if (Model.ListasPublicas.Any())
        {
            @foreach (var lista in Model.ListasPublicas)
            {
                <div class="bg-secondary bg-opacity-10 border border-purple p-3 rounded mb-4 shadow-sm">
                    <div class="d-flex align-items-center justify-content-between mb-3 hover-shadow-roxo">
                        <a href="/Lista/Ver/@lista.ListaJogoId"
                           class="text-decoration-none d-flex align-items-center gap-2 text-purple fw-bold fs-5">
                            <i class="fa-solid fa-folder-open fa-lg"></i>
                            <span class="text-uppercase">@lista.Nome</span>
                        </a>
                    </div>

                    <div class="d-flex flex-wrap gap-3">
                        @foreach (var item in lista.Jogos)
                        {
                            var jogo = item.Jogo;
                            if (jogo != null)
                            {
                                <div class="jogo-card-spotify text-center">
                                    <a href="@Url.Action("Details", "Jogo", new { jogoId = jogo.JogoId })" class="text-decoration-none text-light">
                                        <img src="@jogo.ImagemUrl" alt="@jogo.Nome" class="jogo-thumb" />
                                        <div class="mt-2 jogo-nome">@jogo.Nome</div>
                                    </a>
                                </div>
                            }
                        }
                    </div>
                </div>

            }
        }
        else
        {
            <p class="text-muted">Nenhuma lista pública criada ainda.</p>
        }
    </div>

    <div class="card bg-roxo-claro shadow-lg p-4 mb-4">
        <h4 class="text-white mb-3"><i class="fas fa-thumbs-up text-success me-2"></i>Jogos que Curtiu</h4>
        @if (Model.AvaliacoesLikes.Any())
        {
            <div class="d-flex flex-wrap gap-3">
                @foreach (var like in Model.AvaliacoesLikes)
                {
                    var jogo = like.Jogo;
                    if (jogo != null)
                    {
                        <a href="@Url.Action("Details", "Jogo", new { jogoId = jogo.JogoId })"
                           class="jogo-card-spotify text-decoration-none text-light position-relative">
                            <img src="@jogo.ImagemThumbnailUrl" alt="@jogo.Nome" class="jogo-thumb" />
                            <div class="mt-2 jogo-nome text-center">@jogo.Nome</div>
                        </a>
                    }
                }
            </div>
        }
        else
        {
            <p class="text-muted">Este usuário ainda não curtiu nenhum jogo.</p>
        }
    </div>

    <div class="card bg-roxo-claro shadow-lg p-4 mb-4">
        <h4 class="text-white mb-3"><i class="fas fa-thumbs-down text-danger me-2"></i>Jogos que Não Curtiu</h4>
        @if (Model.AvaliacoesDislikes.Any())
        {
            <div class="d-flex flex-wrap gap-3">
                @foreach (var dislike in Model.AvaliacoesDislikes)
                {
                    var jogo = dislike.Jogo;
                    if (jogo != null)
                    {
                        <a href="@Url.Action("Details", "Jogo", new { jogoId = jogo.JogoId })"
                           class="jogo-card-spotify text-decoration-none text-light position-relative">
                            <img src="@jogo.ImagemThumbnailUrl" alt="@jogo.Nome" class="jogo-thumb" />
                            <div class="mt-2 jogo-nome text-center">@jogo.Nome</div>
                        </a>
                    }
                }
            </div>
        }
        else
        {
            <p class="text-muted">Este usuário ainda não marcou nenhum jogo como "não gostei".</p>
        }
    </div>


    <!-- Comentários -->
    <div class="card bg-roxo-claro shadow-lg p-4 mb-4">
        <h4 class="text-white mb-3"><i class="fa-solid fa-comments text-purple me-2"></i>Comentários em Jogos</h4>
        @if (Model.Comentarios.Any())
        {
            @foreach (var c in Model.Comentarios)
            {
                <div class="bg-dark p-3 rounded mb-3 shadow-sm">
                    <strong class="text-purple">@c.Jogo?.Nome</strong>
                    <span class="text-muted small"> — @c.Data.ToString("dd/MM/yyyy")</span>
                    <p class="mb-0 mt-1">@c.Texto</p>
                </div>
            }
        }
        else
        {
            <p class="text-muted">Este usuário ainda não comentou nenhum jogo.</p>
        }
    </div>
</div>


<style>
    .hover-shadow-roxo:hover {
        box-shadow: 0 0 15px #7e00c8aa;
        border-radius: 8px;
        padding: 4px;
        transition: 0.3s ease;
    }

    .text-purple {
        color: #9d3ce6;
    }

        .text-purple:hover {
            color: #b569ff;
        }

    .fs-5 {
        font-size: 1.2rem;
    }

    .bg-purple {
        background-color: #6a0dad !important;
    }

    .badge-purple {
        background-color: #7c4dff !important;
        color: white !important;
    }

    .btn-outline-purple {
        border: 1px solid #6a0dad;
        color: #6a0dad;
        transition: 0.3s ease;
    }

        .btn-outline-purple:hover {
            background-color: #6a0dad;
            color: white;
        }

    .btn-purple {
        background-color: #7c4dff;
        color: white;
        border: none;
        transition: 0.3s ease;
    }

        .btn-purple:hover {
            background-color: #6a0dad;
            color: white;
        }

    .bg-roxo-claro {
        background: linear-gradient(145deg, #3e0070, #4e008a);
        border: 1px solid #6a0dad44;
        box-shadow: 0 0 10px rgba(122, 0, 200, 0.2);
    }

    .hover-zoom:hover {
        transform: scale(1.05);
        transition: 0.3s ease;
    }

    .border-purple {
        border-color: #6a0dad !important;
    }

    .jogo-card-spotify {
        width: 120px;
        flex-shrink: 0;
        transition: transform 0.3s;
    }

        .jogo-card-spotify:hover {
            transform: scale(1.05);
        }

    .jogo-thumb {
        width: 100%;
        aspect-ratio: 1 / 1;
        object-fit: cover;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
    }

    .jogo-nome {
        font-size: 0.9rem;
        color: #ddd;
        margin-top: 4px;
        font-weight: 500;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .jogo-card-spotify {
        width: 120px;
        flex-shrink: 0;
        transition: transform 0.3s;
    }

        .jogo-card-spotify:hover {
            transform: scale(1.05);
            box-shadow: 0 0 12px #9d3ce6aa;
        }

    .jogo-thumb {
        width: 100%;
        aspect-ratio: 1 / 1;
        object-fit: cover;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
    }

    .jogo-nome {
        font-size: 0.9rem;
        color: #ddd;
        margin-top: 4px;
        font-weight: 500;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }


</style>
