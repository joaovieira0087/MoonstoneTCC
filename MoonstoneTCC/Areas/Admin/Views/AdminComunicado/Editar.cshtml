@model MoonstoneTCC.Models.Comunicado

@{
    ViewData["Title"] = "Editar Comunicado";
}

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    body {
        background-color: #f8f9fa;
    }

    .form-label {
        font-weight: bold;
        color: #3A0066;
    }

    h2 {
        color: #3A0066;
    }

    .btn-purple {
        background-color: #6f42c1;
        color: white;
    }

        .btn-purple:hover {
            background-color: #5a34a1;
        }

    .btn-light {
        border: 1px solid #6f42c1;
        color: #6f42c1;
    }

        .btn-light:hover {
            background-color: #f3e8ff;
        }
</style>

<div class="container mt-5">
    <h2 class="mb-4"><i class="fas fa-edit"></i> Editar Comunicado</h2>

    <form asp-action="Editar" method="post">
        <input type="hidden" asp-for="Id" />

        <div class="form-group mb-3">
            <label class="form-label">Título</label>
            <input asp-for="Titulo" class="form-control" required />
        </div>

        <div class="form-group mb-3">
            <label class="form-label">Mensagem</label>
            <textarea asp-for="Mensagem" class="form-control" rows="5" required></textarea>
        </div>

        <div class="form-group mb-3">
            <label class="form-label">Tipo</label>
            <select asp-for="Tipo" class="form-control" id="tipoSelect" onchange="mostrarCampos()">
                <option value="0">Comunicado</option>
                <option value="1">Enquete</option>
                <option value="2">Pergunta + Resposta</option>
            </select>
        </div>

        <div class="form-group mb-3" id="enqueteCampos" style="display: none;">
            <label class="form-label">Opções da Enquete (separadas por |)</label>
            <input asp-for="OpcoesEnquete" class="form-control" placeholder="Ex: Sim|Não|Talvez" />
        </div>

        <div class="form-group mb-3" id="perguntasCampos" style="display: none;">
            <label class="form-label">Perguntas:</label>
            <div id="containerPerguntas">
                @{
                    var perguntas = ViewBag.Perguntas as List<string>;
                    if (perguntas != null && perguntas.Count > 0)
                    {
                        for (int i = 0; i < perguntas.Count; i++)
                        {
                            <input type="text" name="Perguntas[@i]" class="form-control mb-2" value="@perguntas[i]" />
                        }
                    }
                    else
                    {
                        <input type="text" name="Perguntas[0]" class="form-control mb-2" placeholder="Pergunta 1" />
                    }
                }
            </div>
            <button type="button" class="btn btn-light btn-sm" onclick="adicionarPergunta()">
                <i class="fas fa-plus"></i> Adicionar Pergunta
            </button>
        </div>

        <button type="submit" class="btn btn-purple">
            <i class="fas fa-save"></i> Salvar Alterações
        </button>
        <a asp-action="Index" class="btn btn-secondary">Cancelar</a>
    </form>
</div>

@section Scripts {
    <script>
        function mostrarCampos() {
            var tipo = document.getElementById("tipoSelect").value;
            document.getElementById("enqueteCampos").style.display = (tipo == "1") ? "block" : "none";
            document.getElementById("perguntasCampos").style.display = (tipo == "2") ? "block" : "none";
        }

        function adicionarPergunta() {
            var container = document.getElementById("containerPerguntas");
            var count = container.querySelectorAll("input").length;
            var input = document.createElement("input");
            input.type = "text";
            input.name = `Perguntas[${count}]`;
            input.className = "form-control mb-2";
            input.placeholder = `Pergunta ${count + 1}`;
            container.appendChild(input);
        }

        window.onload = function () {
            mostrarCampos();
        };
    </script>
}
